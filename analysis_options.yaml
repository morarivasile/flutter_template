include: package:very_good_analysis/analysis_options.yaml

analyzer:
  language:
    strict-casts: true
    strict-inference: true
    strict-raw-types: true
  errors:
    # treat missing required parameters as an error (not a hint)
    missing_required_param: error
    # treat missing returns as an error (not a hint)
    missing_return: error
    # Reassignment should be treated as warning (not a hint)
    no_default_cases: ignore
    parameter_assignments: warning
  plugins:
    - dart_code_metrics

  # Exclude auto-generated files from dart analysis
  exclude:
    - '**/lib/**.freezed.dart'
    - '**/lib/**/di.config.dart'
    - '**/lib/**.g.dart'
    - '**/lib/**.gr.dart'
    - '**/test/**.freezed.dart'
    - '**/test/**.g.dart'
    - '**/test/**.mocks.dart'
    - '**/lib/i18n/**.i69n.dart'

dart_code_metrics:
  metrics:
    cyclomatic-complexity: 20
    halstead-volume: 150
    lines-of-code: 100
    source-lines-of-code: 75
    maintainability-index: 50
    maximum-nesting-level: 5
    maximum-nesting: 5
    number-of-methods: 10
    number-of-parameters: 4
    technical-debt:
      threshold: 16
      todo-cost: 4
      ignore-cost: 8
      ignore-for-file-cost: 16
      as-dynamic-cost: 16
      deprecated-annotations-cost: 2
      file-nullsafety-migration-cost: 2
      unit-type: "hours"
  anti-patterns:
    - long-method:
        exclude:
          - '**/test/**_test.dart'

  rules:
    - avoid-banned-imports:
        entries:
          # Deny Flutter imports from core, data and domain packages
          - paths: [ "packages/core/.*.dart", "packages/data/.*.dart", "packages/domain/.*.dart" ]
            deny: [ "package:flutter/.*.dart" ]
            message: "Do not import Flutter Material Design library, we should not depend on it!"
          # Deny data and presentation imports from domain package
          - paths: [ "packages/domain/.*.dart" ]
            deny: [ "package:data/.*.dart", "package:presentation/.*.dart" ]
            message: "Domain package should not depend on data or presentation layers!"
          # Deny data imports from presentation package
          - paths: [ "packages/presentation/.*.dart" ]
            deny: [ "package:data/.*.dart" ]
            message: "Presentation package should not depend on data layer!"
          # Absolutely no package should depend on app (except itself, of course)
          - paths: [ "packages/core/.*.dart", "packages/data/.*.dart", "packages/domain/.*.dart", "packages/presentation/.*.dart" ]
            deny: [ "package:app/.*.dart" ]
            message: "Do not import app package, we should not depend on it!"
          - paths: [ "packages/presentation/screens/home/*.dart" ]
            deny: [ "package:flutter/widgets.dart" ]
            message: "Test 1"
          - paths: [ "packages/presentation/screens/home/.*.dart" ]
            deny: [ "package:flutter/widgets.dart" ]
            message: "Test 2"
    - avoid-cascade-after-if-null
    - avoid-collection-methods-with-unrelated-types
    - avoid-double-slash-imports
    - avoid-duplicate-exports
    - avoid-global-state
    - avoid-missing-enum-constant-in-map
    - avoid-nested-conditional-expressions:
        acceptable-level: 1
    - avoid-non-ascii-symbols
    - avoid-redundant-async
    - avoid-top-level-members-in-tests:
        exclude:
          - "**/test/mocks/**"
    - avoid-unnecessary-conditionals
    - avoid-unnecessary-type-assertions
    - avoid-unnecessary-type-casts
    - avoid-unrelated-type-assertions
    - avoid-unused-parameters
    - binary-expression-operand-order
    - double-literal-format
    - member-ordering
    - missing-test-assertion:
        include-assertions: [ 'verify', 'verifyNever' ]
    - no-boolean-literal-compare
    - no-empty-block:
        exclude:
          - "**/test/**"
    - no-equal-then-else
    - no-magic-number:
        allowed: [ -1, 0, 1, 2 ]
        exclude:
          - "**/test/**"
    - no-object-declaration
    - prefer-commenting-analyzer-ignores
    - prefer-correct-identifier-length:
        exceptions:
          # counters
          - i
          - j
          # coordinates
          - x
          - y
          # various
          - id
          - db
          # Theme spacings
          - xs
          - xl
          - s
          - m
          - sm
          - l
          - lm
    - prefer-correct-test-file-name
    - prefer-correct-type-name:
        min-length: 3
        max-length: 50
    - prefer-enums-by-name
    - prefer-first
    - prefer-immediate-return
    - prefer-iterable-of
    - prefer-last
    - prefer-static-class:
        - ignore-private: true
    - prefer-trailing-comma
    - always-remove-listener
    - avoid-border-all
    - avoid-expanded-as-spacer
    - avoid-returning-widgets:
        exclude:
          - '**/test/**_test.dart'
    - avoid-shrink-wrap-in-lists
    - avoid-unnecessary-setstate
    - avoid-wrapping-in-padding
    - check-for-equals-in-render-object-setters
    - consistent-update-render-object
    - prefer-const-border-radius
    - prefer-correct-edge-insets-constructor
    - prefer-single-widget-per-file:
        ignore-private-widgets: true
    - prefer-using-list-view
    - use-setstate-synchronously

    - avoid-passing-async-when-sync-expected:
      exclude:
        - '**/test/**'

linter:
  rules:
    always_put_required_named_parameters_first: true
    avoid_returning_null: true
    lines_longer_than_80_chars: false
    omit_local_variable_types: false
    one_member_abstracts: false
    package_api_docs: false
    public_member_api_docs: false
    prefer_int_literals: false
    sort_pub_dependencies: false
    prefer_single_quotes: false
    sort_constructors_first: false
    collection_methods_unrelated_type: true
    combinators_ordering: true
    dangling_library_doc_comments: true
    library_annotations: true
    unnecessary_library_directive: true
    implicit_call_tearoffs: true
    unreachable_from_main: true
    use_string_in_part_of_directives: true
    avoid_catching_errors: false
    avoid_returning_this: false
    prefer_constructors_over_static_methods: false